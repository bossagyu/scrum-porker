# スクラムポーカー - 機能要件・画面設計書

## 1. 機能要件一覧（MoSCoW優先度）

### Must Have（v1必須機能）
- **ルーム作成・管理**
  - ルーム名の設定
  - 一意のルームID自動生成
  - 参加用URL自動生成
- **参加機能**
  - URLによる簡単参加（アカウント不要）
  - 参加者名の設定
  - 参加者一覧のリアルタイム表示
- **投票機能**
  - カード選択（フィボナッチ数列: 0, 1, 2, 3, 5, 8, 13, 21, 34, ?, ∞）
  - 投票状態のリアルタイム反映（未投票/投票済み）
  - 投票のやり直し（公開前）
- **結果公開・集計**
  - ファシリテーターによる一斉公開
  - 結果サマリー表示（平均値、中央値、最頻値）
  - 投票分布の可視化
- **セッション管理**
  - 複数ラウンドの投票
  - ラウンドリセット機能

### Should Have（v1推奨機能）
- **カスタムカードセット**
  - フィボナッチ数列（デフォルト）
  - Tシャツサイズ（XS, S, M, L, XL, XXL）
  - 2のべき乗（1, 2, 4, 8, 16, 32）
  - カスタムセット作成機能
- **タイマー機能**
  - 投票時間制限設定（30秒、1分、2分、5分）
  - カウントダウン表示
  - タイムアップ時の自動公開
- **投票履歴**
  - 過去のラウンド結果表示
  - ラウンド別サマリー
  - CSV/JSONエクスポート
- **ファシリテーター機能**
  - ルーム作成者が自動でファシリテーター
  - ファシリテーター移譲機能
  - 参加者の強制退室（荒らし対策）

### Could Have（将来的な追加機能）
- **外部連携**
  - Jira Issues連携（投票対象の自動取込）
  - GitHub Issues連携
  - Slack通知
- **UI/UX拡張**
  - ダークモード
  - 絵文字リアクション
  - カスタムテーマ
  - アバター設定
- **分析機能**
  - チーム別見積もり傾向分析
  - 見積もり精度レポート
  - 投票時間分析

### Won't Have（v1では実装しない）
- ネイティブモバイルアプリ
- チャット機能（Slack等の既存ツール活用を推奨）
- ユーザー認証・アカウント管理（v1はゲストのみ）
- 有料プラン・課金機能
- オフライン対応

## 2. ユーザーフロー

### 2.1 ファシリテーターフロー
```
1. トップページアクセス
   ↓
2. 「ルーム作成」ボタンクリック
   ↓
3. ルーム設定入力
   - ルーム名
   - カードセット選択
   - タイマー設定（オプション）
   ↓
4. ルーム作成完了
   - 参加用URLコピー
   - チームに共有（Slack/メール等）
   ↓
5. 投票画面で待機
   - 参加者の入室確認
   - 投票対象の説明（口頭/チャットツール）
   ↓
6. 参加者の投票を確認
   - 投票状態のリアルタイム表示
   ↓
7. 全員投票完了後、「公開」ボタンクリック
   ↓
8. 結果確認・議論
   - 結果サマリー表示
   - 分布の可視化
   ↓
9. 次のラウンド or 終了
   - 「リセット」→ステップ5へ
   - 「履歴確認」→ CSV/JSONエクスポート
   - 「ルーム終了」→ トップページへ
```

### 2.2 参加者フロー
```
1. 参加用URLをクリック
   ↓
2. 参加者名入力
   ↓
3. ルーム参加完了
   ↓
4. 投票画面表示
   - 投票対象を確認（ファシリテーターから説明）
   ↓
5. カード選択
   - カードをクリック
   - 選択カードのハイライト表示
   - 投票状態が「投票済み」に変更
   ↓
6. 結果公開待機
   - 他の参加者の投票状態確認
   - 投票変更可能（公開前）
   ↓
7. 結果公開
   - 全員の投票結果表示
   - サマリー情報表示
   ↓
8. 次のラウンド or 退室
   - 「リセット」→ ステップ4へ
   - 「退室」→ トップページへ
```

### 2.3 複数ラウンド投票フロー
```
ラウンド1: ユーザーストーリーA
  投票 → 公開 → 議論 → 合意
    ↓
  リセット
    ↓
ラウンド2: ユーザーストーリーB
  投票 → 公開 → 議論 → 合意
    ↓
  リセット
    ↓
  ...
    ↓
セッション終了
  履歴確認 → エクスポート → ルーム終了
```

## 3. 主要画面設計（テキストベースワイヤーフレーム）

### 3.1 トップページ / ルーム作成画面

```
┌─────────────────────────────────────────────────────────────┐
│                    🃏 Scrum Poker                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    シンプルで使いやすいスクラムポーカーツール              │
│    アカウント不要、URLを共有するだけで開始                 │
│                                                             │
│    ┌─────────────────────────────────────────────────┐    │
│    │  ルーム名を入力                                  │    │
│    │  [_________________________________]             │    │
│    └─────────────────────────────────────────────────┘    │
│                                                             │
│    ┌─────────────────────────────────────────────────┐    │
│    │  カードセット                                    │    │
│    │  ○ フィボナッチ数列（デフォルト）               │    │
│    │  ○ Tシャツサイズ                                │    │
│    │  ○ 2のべき乗                                    │    │
│    │  ○ カスタム                                      │    │
│    └─────────────────────────────────────────────────┘    │
│                                                             │
│    ┌─────────────────────────────────────────────────┐    │
│    │  タイマー（オプション）                          │    │
│    │  ○ なし  ○ 30秒  ○ 1分  ○ 2分  ○ 5分          │    │
│    └─────────────────────────────────────────────────┘    │
│                                                             │
│              [      ルームを作成      ]                    │
│                                                             │
│    ─────────────────────────────────────────────────      │
│                                                             │
│    既にルームIDをお持ちですか？                            │
│    [ルームIDを入力] [参加]                                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 ルーム作成完了・URL共有画面

```
┌─────────────────────────────────────────────────────────────┐
│  🃏 Scrum Poker  >  ルーム作成完了                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ✅ ルーム「スプリント15プランニング」を作成しました       │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  参加用URL                                           │  │
│  │  https://scrumpoker.app/room/abc123xyz               │  │
│  │                               [📋 コピー]           │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  このURLをチームメンバーに共有してください                 │
│  Slack、メール、チャットツールなどで送信                   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ルームID: abc123xyz                                 │  │
│  │  カードセット: フィボナッチ数列                      │  │
│  │  タイマー: 1分                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│              [   投票画面へ進む   ]                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 投票画面（投票中）

```
┌─────────────────────────────────────────────────────────────┐
│  🃏 Scrum Poker  >  スプリント15プランニング               │
│  ルームID: abc123xyz                    [⚙️設定] [📊履歴]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ラウンド #1                                    ⏱️ 0:42    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  参加者 (5名)                                        │  │
│  │                                                       │  │
│  │  🟢 Alice (ファシリテーター)     ✅ 投票済み         │  │
│  │  🟢 Bob                           ✅ 投票済み         │  │
│  │  🟢 Carol                         ✅ 投票済み         │  │
│  │  🟢 Dave                          ⏳ 未投票           │  │
│  │  🟢 Eve                           ✅ 投票済み         │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  あなたの投票: 5 ポイント                                  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  カードを選択してください                            │  │
│  │                                                       │  │
│  │  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐            │  │
│  │  │ 0 │ │ 1 │ │ 2 │ │ 3 │ │ 5 │ │ 8 │            │  │
│  │  └───┘ └───┘ └───┘ └───┘ └─▼─┘ └───┘            │  │
│  │                                  (選択中)            │  │
│  │  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐            │  │
│  │  │ 13│ │ 21│ │ 34│ │ ? │ │ ∞ │ │ ☕│            │  │
│  │  └───┘ └───┘ └───┘ └───┘ └───┘ └───┘            │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  [  投票を変更  ]           [  結果を公開  ] ←ファシリ   │
│                                              テーターのみ  │
└─────────────────────────────────────────────────────────────┘
```

### 3.4 結果表示画面

```
┌─────────────────────────────────────────────────────────────┐
│  🃏 Scrum Poker  >  スプリント15プランニング               │
│  ルームID: abc123xyz                    [⚙️設定] [📊履歴]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ラウンド #1 - 結果                                         │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  📊 サマリー                                         │  │
│  │                                                       │  │
│  │  平均値:    6.4 ポイント                             │  │
│  │  中央値:    5 ポイント                               │  │
│  │  最頻値:    5 ポイント                               │  │
│  │  範囲:      3 - 13 ポイント                          │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  👥 参加者別結果                                     │  │
│  │                                                       │  │
│  │  Alice (ファシリテーター)     5 ポイント            │  │
│  │  Bob                           5 ポイント            │  │
│  │  Carol                         3 ポイント            │  │
│  │  Dave                          8 ポイント            │  │
│  │  Eve                           13 ポイント           │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  📈 分布                                             │  │
│  │                                                       │  │
│  │  3  ██ (1)                                           │  │
│  │  5  ████ (2)                                         │  │
│  │  8  ██ (1)                                           │  │
│  │  13 ██ (1)                                           │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  [  次のラウンド  ]  [  結果をエクスポート  ]  [  終了  ] │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.5 設定画面

```
┌─────────────────────────────────────────────────────────────┐
│  🃏 Scrum Poker  >  設定                                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ルーム設定                                          │  │
│  │                                                       │  │
│  │  ルーム名                                            │  │
│  │  [スプリント15プランニング________________]          │  │
│  │                                                       │  │
│  │  カードセット                                        │  │
│  │  ● フィボナッチ数列                                  │  │
│  │  ○ Tシャツサイズ                                    │  │
│  │  ○ 2のべき乗                                        │  │
│  │  ○ カスタム                                          │  │
│  │                                                       │  │
│  │  タイマー                                            │  │
│  │  ○ なし  ● 1分  ○ 2分  ○ 5分                       │  │
│  │                                                       │  │
│  │  自動公開                                            │  │
│  │  ☑ タイマー終了時に自動公開                         │  │
│  │  ☑ 全員投票完了時に自動公開                         │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ファシリテーター設定                                │  │
│  │                                                       │  │
│  │  現在のファシリテーター: Alice                       │  │
│  │                                                       │  │
│  │  移譲先を選択                                        │  │
│  │  [  Bob  ▼]  [移譲]                                 │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  参加者管理                                          │  │
│  │                                                       │  │
│  │  Alice (ファシリテーター)                           │  │
│  │  Bob                                    [退室]       │  │
│  │  Carol                                  [退室]       │  │
│  │  Dave                                   [退室]       │  │
│  │  Eve                                    [退室]       │  │
│  │                                                       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  [  保存  ]  [  キャンセル  ]                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.6 履歴画面

```
┌─────────────────────────────────────────────────────────────┐
│  🃏 Scrum Poker  >  投票履歴                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ルーム: スプリント15プランニング                          │
│  セッション日時: 2026-02-08 14:30 - 15:45                 │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ラウンド #1                              14:32     │  │
│  │  平均: 6.4  中央値: 5  最頻値: 5                    │  │
│  │  Alice(5) Bob(5) Carol(3) Dave(8) Eve(13)          │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ラウンド #2                              14:38     │  │
│  │  平均: 8.2  中央値: 8  最頻値: 8                    │  │
│  │  Alice(8) Bob(8) Carol(5) Dave(8) Eve(13)          │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ラウンド #3                              14:45     │  │
│  │  平均: 3.4  中央値: 3  最頻値: 3                    │  │
│  │  Alice(3) Bob(3) Carol(2) Dave(5) Eve(5)           │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐  │
│  │  ラウンド #4                              14:52     │  │
│  │  平均: 12.6  中央値: 13  最頻値: 13                 │  │
│  │  Alice(13) Bob(13) Carol(8) Dave(13) Eve(21)       │  │
│  └─────────────────────────────────────────────────────┘  │
│                                                             │
│  [  CSVエクスポート  ]  [  JSONエクスポート  ]  [  戻る  ] │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 4. 非機能要件

### 4.1 パフォーマンス要件

**同時接続数**
- 想定: 1ルームあたり5-20名
- 最大サポート: 1ルームあたり100名
- 同時稼働ルーム数: 10,000ルーム（将来的）
- 初期目標: 100ルーム同時稼働

**レスポンスタイム**
- ページ初期表示: < 2秒
- カード選択後の反映: < 500ms
- 結果公開後の表示: < 1秒
- リアルタイム同期遅延: < 500ms

**帯域幅**
- WebSocket通信: 平均 < 10KB/秒/ユーザー
- 初期ページロード: < 500KB（圧縮後）

### 4.2 可用性・信頼性

**稼働率**
- 目標稼働率: 99.5%（月間ダウンタイム < 3.6時間）
- メンテナンスウィンドウ: 月1回、深夜時間帯

**データ永続性**
- アクティブセッション: リアルタイム同期
- 投票履歴: 72時間保持
- エクスポートデータ: ユーザー側で管理

**障害復旧**
- WebSocket切断時の自動再接続
- ネットワーク復旧後のステート同期
- ブラウザリロード時のセッション復元

### 4.3 セキュリティ要件

**認証・認可**
- ルームIDによるアクセス制御（知っている人のみ参加）
- ルームID生成: ランダム文字列（衝突率 < 0.001%）
- ファシリテーター権限管理

**データ保護**
- HTTPS通信（TLS 1.3）
- WebSocket暗号化（WSS）
- XSS対策（入力サニタイズ）
- CSRF対策（トークン検証）
- Rate Limiting（API: 100req/min/IP）

**プライバシー**
- 個人情報収集最小化（名前・投票結果のみ）
- Cookie使用最小限（セッションIDのみ）
- データ保持期間: 72時間（自動削除）
- GDPR準拠（EU対応時）

### 4.4 アクセシビリティ（WCAG 2.1 AA準拠）

**キーボード操作**
- Tab順序の論理的な配置
- カード選択: 矢印キー + Enter
- モーダル: Escでクローズ
- フォーカスインジケーター明確化

**スクリーンリーダー対応**
- セマンティックHTML使用
- ARIA属性の適切な設定
- 投票状態の音声フィードバック
- 結果公開時のライブリージョン通知

**視覚的配慮**
- コントラスト比: 最低4.5:1（テキスト）
- 色だけに依存しない情報伝達（アイコン併用）
- フォントサイズ: 最低16px
- ズーム対応: 200%までレイアウト崩れなし

**操作性**
- タッチターゲット: 最低44x44px
- エラーメッセージの明確化
- タイムアウト前の警告（30秒前）

### 4.5 モバイルレスポンシブ

**ブレークポイント**
- Mobile: < 640px
- Tablet: 640px - 1024px
- Desktop: > 1024px

**モバイル最適化**
- カード選択UIの大型化（タッチ操作）
- 縦スクロールで全機能アクセス
- ハンバーガーメニュー（設定・履歴）
- PWA対応（ホーム画面追加）

**タブレット最適化**
- 2カラムレイアウト（参加者一覧 + カード選択）
- 横向き対応
- Split View対応

**デスクトップ最適化**
- 3カラムレイアウト（参加者・カード・サマリー）
- ショートカットキー対応
- 複数ウィンドウ対応

### 4.6 ブラウザ互換性

**対応ブラウザ**
- Chrome: 最新版 + 1つ前のバージョン
- Firefox: 最新版 + 1つ前のバージョン
- Safari: 最新版 + 1つ前のバージョン
- Edge: 最新版 + 1つ前のバージョン

**必須技術**
- WebSocket対応
- localStorage対応
- ES2020+（モジュールバンドラー使用）
- CSS Grid / Flexbox

### 4.7 国際化（i18n）

**初期対応言語**
- 日本語（デフォルト）
- 英語

**将来対応予定**
- 中国語（簡体字・繁体字）
- 韓国語
- スペイン語

**対応項目**
- UI文字列
- 日時フォーマット
- 数値フォーマット
- エラーメッセージ

### 4.8 監視・ログ

**アプリケーション監視**
- エラーレート（目標: < 1%）
- レスポンスタイム（P95 < 1秒）
- WebSocket接続成功率（> 99%）
- アクティブセッション数

**ログ収集**
- アプリケーションログ（Error, Warn, Info）
- アクセスログ
- WebSocketイベントログ
- パフォーマンスメトリクス

**アラート設定**
- エラーレート急増（5分間で10%以上）
- レスポンスタイム悪化（P95 > 3秒）
- サーバーダウン検知（3分間応答なし）

---

## 付録: カードセット詳細

### フィボナッチ数列（デフォルト）
```
0, 1, 2, 3, 5, 8, 13, 21, 34, ?, ∞, ☕
```
- ?: 不明・要調査
- ∞: 大きすぎて見積もり不可
- ☕: 休憩提案

### Tシャツサイズ
```
XS, S, M, L, XL, XXL, ?, ☕
```

### 2のべき乗
```
1, 2, 4, 8, 16, 32, 64, ?, ∞, ☕
```

### カスタムセット作成ルール
- 最小3枚、最大15枚
- 各カードは1-3文字（数字・記号・絵文字）
- 特殊カード（?, ∞, ☕）は常に利用可能

---

**文書バージョン:** 1.0
**作成日:** 2026-02-08
**作成者:** designer
**承認者:** （team-lead承認待ち）
